---
title: "Honolulu"
author: "Luciana"
date: "1/29/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## R Markdown

```{r}
rm(list = ls())
```

```{r}
install.packages('')
```


```{r}
# load libraries for leaflet - map 
library(dplyr)
library(rgdal)
library(ggplot2)
library(leaflet)
# set factors to false
options(stringsAsFactors = FALSE)


```


```{r}
library(tidyverse)
library(janitor)
library(arcos)
library(scales)
library(revgeo)
library(ggrepel)
library(tidycensus)
library(readr)
library(viridis)
library(mapview)
library(ggthemes)
library(datasets)
library(plotly)
library(lubridate)
library(ggmap)
library(tidyr)
library(revgeo)
```


311 Calls fom 2011 to 2019 in Honolulu. Non-emergency/ complaints. 

```{r}
Honolulu_2011_2019 <-read_csv ("data/Honolulu_311_2011_2019.csv")
```

```{r}

# need to eliminate year 1899 as it marks fields without year 

Honolulu_Edit <- Honolulu_2011_2019 %>%
  filter(!str_detect(YEAR, '1899')) %>% 
  select(id, ReportType, CurrentStatus, Description, DateCreate_Converted,location, YEAR) %>%
  separate( location, into = c("latitude","longitude"), sep = ",", extra = "merge") %>% 
  select(id, ReportType, CurrentStatus, Description, DateCreate_Converted, latitude, longitude, YEAR)%>%
  print()

```

``` {r}
 # eliminate parathenses signs
Honolulu_Edit$latitude = as.numeric(gsub("[\\(),]", "", Honolulu_Edit$latitude))
Honolulu_Edit$longitude = as.numeric(gsub("[\\(),]", "", Honolulu_Edit$longitude))

```

```{r}

# need to eliminate year 1899 as it marks fields without year 

Honolulu_Edit_Homeless <- Honolulu_Edit %>%
  filter(ReportType == 'Homeless') %>% 
  print()

```





Has there been an uptick in calls related to homelessness in comparison to other types of calls?  (utilized Honolulu edited dataset) â€“ 

As a percentage of all calls, calls related to homelessness have not increased. 

One interesting case is that from 2017 to 2019 there is a downward trend in the volume of all types of calls while there is an increase in calls related to homelessness. 

2011 is an outlier. It would seem data was not yet tracked for this year, or at least not comprehensively. It would be important to look further into this. 

The year with most calls (as a percentage of the whole and excluding 2011) related to homelessness is in 2012. After that the order from most to least reports is 2013, 2016, 2019 and 2018. 


 - 2011 - 1 out of 13 reports (7.69%) are categorized under homeless.  
 - 2012 - 340 out of 4221 reports (8.05%) are categorized under homeless.  
 - 2013 - 179 out of 3106 reports (5.76 %) are categorized under homeless. 
 - 2014 - 124 out of 2324 reports (3.07 %) are categorized under homeless. 
 - 2015 - 71 out of 2310 (3.07 %) observations in 2015 are filed under Report Type Homeless. 
 - 2016 - 100 out of 3182 observations (5.71 %) are filed under Report Type Homeless. Current Status of some of the reports start showing "Referred to Department". This was not the case in the prior years.   
 - 2017 - 152 out of 4231 (3.59%) observations are filed under Report Type Homeless. More "Referred to Department".   
 - 2018 - 123 out of 2840 (4.33%) observations are filed under Report Type Homeless. More "Referred to Department".  
 -2019 - 61 out of 1358 (4.49%) observations are filed under Report Type Homeless. More "Referred to Department".  
 
 
Interesting examples? 
Where are the calls coming from? 
Search for any terms referring to homelessness under other terminology/ or reports filed as homelessness that are actually something else (campers for example)
are there more reports in locations experimenting gentrification (year by year)?
written by citizens/ gov officials 



2011 - 

1  out of 13 reports (7.69% ) are categorized under homeless. 
In 2011 only one Report type for Homeless is populated. 
Homeless ( Couldn't choose other option for issue. Correct issue bulb burnt out/flashing on light pole. ) - 	12/6/11 18:22 
Why were there so few reports in 2011? Did data tracking not begin until later? 

```{r}

honolulu_2011 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2011') %>% 
  print()

honolulu_2011 %>% filter(ReportType == 'Homeless')
``` 



2012 - 
340  out of 4221 reports (8.05% )  are categorized under homeless. 
Many of the case description udner homeless mention "	Mopeds are stored here" or things like " This moped frequently parks on the sidewalk in front of 1505 Kewalo st. It's there now. License # R 39814". This might be a report type error. 

Homeless camp/ encampment 


```{r}

honolulu_2012 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2012') %>% 
  print()

honolulu_2012 %>% filter(ReportType == 'Homeless') %>% print()
``` 

2013 -

179 out of 3106 reports ( 5.76 % )  are categorized under homeless. 

Homeless camp/ encampment/ smell. Certain complaints are not regarding homlessness, for example "This is a no parking zone until 9 am but many people park here from 8:40 or 8:45 am everyday. Common description is also ilegal storage / building material / ilegal parking. 


```{r}

honolulu_2013 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2013') %>% 
  print()

honolulu_2013 %>% filter(ReportType == 'Homeless') %>% print()
``` 


2014 - 124 out of 2324 reports (3.07 %)  are categorized under homeless. 

```{r}

honolulu_2014 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2014') %>% 
  print()

honolulu_2014 %>% filter(ReportType == 'Homeless') %>% print()
``` 


2015 - 71 out of 2310  (3.07 %) observations in 2015 are filed under Report Type Homeless. 

```{r}

honolulu_2015 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2015') %>% 
  print()

honolulu_2015 %>% filter(ReportType == 'Homeless') %>% print()
``` 


2016 - 100 out of 3182 observations (5.71 %) are filed under Report Type Homeless. CurrentStatus of some of the reports start showing "Referred to Department". This was not the case in the prior years.  
```{r}

Honolulu_Edit_Homeless <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2016') %>% 
  print()


honolulu_2016 %>% filter(ReportType == 'Homeless') %>% print()
```


2017 - 152 out of 4231 (3.59%) observations are filed under Report Type Homeless. More "Referred to Department". 
```{r}

honolulu_2017 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2017') %>% 
  print()


honolulu_2017 %>% filter(ReportType == 'Homeless') %>% print()
```



2018 - 123 out of 2840 (4.33%) observations are filed under Report Type Homeless. More "Referred to Department". 
```{r} 
honolulu_2018 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2018') %>% 
  print()


honolulu_2018 %>% filter(ReportType == 'Homeless') %>% print()
```

2019 - 61 out of 1358 (4.49%) observations are filed under Report Type Homeless. More "Referred to Department". 
```{r}

honolulu_2019 <-  Honolulu_2011_2019 %>%
  select (id,ReportType,CurrentStatus,Description,DateCreate_Converted, DateClosed_Converted,location,YEAR) %>%
  filter(YEAR =='2019') %>% 
  print()




honolulu_2019 %>% filter(ReportType == 'Homeless') %>% print()
``` 




Leaflet analysis 2011- 2019 

```{r}
#All complaints from 2011 to 2019 
# Color Scheme
binpal <- colorBin("plasma", Honolulu_Edit_Homeless$YEAR, 5, pretty = FALSE)


# Show first 20 rows from the `quakes` dataset
leaflet(data = Honolulu_Edit_Homeless) %>% addTiles() %>%
  addMarkers(~longitude, ~latitude, , popup = ~as.character(YEAR), label = ~as.character(YEAR))
``` 

```{r}
leaflet(Honolulu_Edit_Homeless) %>% addTiles() %>%
  addMarkers( ~longitude, ~latitude, , popup = ~as.character(YEAR), label = ~as.character(YEAR),
  clusterOptions = markerClusterOptions(freezeAtZoom = ),
)
```





